<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>d'Titanium - Form Pemesanan</title>

<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:#fff;}
header{background:#111;padding:20px;text-align:center;}
header h1{color:#d4af37;margin:0;}
section{padding:40px 20px;text-align:center;}
form{max-width:600px;margin:auto;text-align:left;}
input,select,textarea{
width:100%;padding:10px;margin:8px 0;border-radius:5px;border:none;
}
.btn{
display:inline-block;padding:12px 25px;background:#d4af37;
color:black;font-weight:bold;border-radius:5px;cursor:pointer;border:none;
}
footer{background:#111;padding:20px;text-align:center;font-size:14px;margin-top:40px;}
</style>
</head>
<body>

<header>
<h1>d'Titanium</h1>
</header>

<section>
<h2>Form Pemesanan</h2>

<form onsubmit="submitOrder(); return false;">

<label>Nama Lengkap</label>
<input type="text" id="nama" required>

<label>Nomor HP</label>
<input type="tel" id="hp" required>

<label>Pilih Produk</label>
<select id="produk">
<option value="Cincin Titanium - Rp 499.000">Cincin Titanium</option>
<option value="Gelang Titanium - Rp 699.000">Gelang Titanium</option>
<option value="Kalung Titanium - Rp 799.000">Kalung Titanium</option>
</select>

<label>Provinsi</label>
<select id="provinsi" onchange="loadKota()" required>
<option value="">Memuat provinsi...</option>
</select>

<label>Kabupaten / Kota</label>
<select id="kota" onchange="loadKecamatan()" required>
<option value="">Pilih Provinsi dulu</option>
</select>

<label>Kecamatan</label>
<select id="kecamatan" onchange="generateKodePos()" required>
<option value="">Pilih Kota dulu</option>
</select>

<label>Kode Pos</label>
<input type="text" id="kodepos" readonly placeholder="Otomatis muncul">

<label>Alamat Lengkap</label>
<textarea id="alamat" rows="3" required></textarea>

<button type="submit" class="btn">Kirim Pesanan</button>

</form>
</section>

<footer>Â© 2026 d'Titanium</footer>

<script>

async function loadProvinsi() {
try{
let res = await fetch("https://www.emsifa.com/api-wilayah-indonesia/api/provinces.json");
let data = await res.json();
let select = document.getElementById("provinsi");
select.innerHTML = '<option value="">Pilih Provinsi</option>';

data.forEach(p => {
let opt = document.createElement("option");
opt.value = p.id;
opt.text = p.name;
select.add(opt);
});
}catch(err){
document.getElementById("provinsi").innerHTML =
'<option value="">Gagal load data</option>';
}
}

async function loadKota() {
let provId = document.getElementById("provinsi").value;
let kotaSelect = document.getElementById("kota");
let kecSelect = document.getElementById("kecamatan");

kotaSelect.innerHTML = '<option value="">Memuat...</option>';
kecSelect.innerHTML = '<option value="">Pilih Kota dulu</option>';
document.getElementById("kodepos").value = "";

try{
let res = await fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/regencies/${provId}.json`);
let data = await res.json();

kotaSelect.innerHTML = '<option value="">Pilih Kabupaten/Kota</option>';

data.forEach(k => {
let opt = document.createElement("option");
opt.value = k.id;
opt.text = k.name;
kotaSelect.add(opt);
});
}catch(err){
kotaSelect.innerHTML = '<option value="">Gagal load kota</option>';
}
}

async function loadKecamatan() {
let kotaId = document.getElementById("kota").value;
let kecSelect = document.getElementById("kecamatan");

kecSelect.innerHTML = '<option value="">Memuat...</option>';
document.getElementById("kodepos").value = "";

try{
let res = await fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/districts/${kotaId}.json`);
let data = await res.json();

kecSelect.innerHTML = '<option value="">Pilih Kecamatan</option>';

data.forEach(k => {
let opt = document.createElement("option");
opt.value = k.name;
opt.text = k.name;
kecSelect.add(opt);
});
}catch(err){
kecSelect.innerHTML = '<option value="">Gagal load kecamatan</option>';
}
}

async function generateKodePos(){
let kecamatan = document.getElementById("kecamatan").value;
let kodeInput = document.getElementById("kodepos");

if(!kecamatan){
kodeInput.value = "";
return;
}

try{
let res = await fetch(`https://api.binderbyte.com/wilayah/kodepos?api_key=ISI_APIKEY_ANDA&kecamatan=${kecamatan}`);
let data = await res.json();

if(data.status == 200 && data.value.length > 0){
kodeInput.value = data.value[0].kodepos;
}else{
kodeInput.value = "Tidak ditemukan";
}
}catch(err){
kodeInput.value = "Error API";
}
}


let message =
`Halo d'Titanium,%0A%0ASaya ingin memesan:%0AProduk: ${produk}%0ANama: ${nama}%0ANo HP: ${hp}%0AAlamat: ${alamat}, ${kec}, ${kotaText}, ${provText}%0AKode Pos: ${kodepos}`;

window.open(`https://wa.me/6285205808800?text=${message}`);
}

window.onload = loadProvinsi;

</script>

</body>
</html>
